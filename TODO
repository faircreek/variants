Port all variant functionaly from NDD.
